# ExploitFixer by LinsaFTW
# Please help by donating, we require funds to continue with the development.
# https://paypal.me/LinsaFTW
#
# WARNING: Only Notifications, Connection, Commands and Packets (CustomPayload only) modules work on BungeeCord.
#
# This is because the other modules can't be executed on BungeeCord.
# The other modules require ExploitFixer to be installed on Bukkit with HamsterAPI. (No performance impact)
#
# INSTALL THE PLUGIN ON BUNGEECORD AND ALL BUKKIT SERVERS!
#
# Most of the check use Violations (vls), this a counter to execute different
# actions on diverse levels to allow high customization of the modules.

# Default language used by the plugin (This changes depending on the client language)
locale: "en"

# Shows notifications to console and players with permissions.
notifications:
  enabled: true

  # Placeholders: %player% %ping% %check% %vls%
  message: "&c&lEF: &e%player% &7(&a%ping%ms&7) &ffailed &6%check% &7(&c%vls% vls&7)"

  # This shows extra information about packets blocked.
  # Useful to identify false positives and reporting errors.
  debug: false

# Prevents a variety of exploits that occur on player connection.
# Players wont be able to type messages/commands until the connection is secured. (You won't notice this)
connection:
  # Prevents changing UUIDs with spoofed BungeeCord IP Forwarding.
  # UUIDSpoof only affects non-firewalled servers with bungeecord: true.
  uuidspoof: true

  # Prevents null addresses from fake Bungee IP Forwarding to bypass IP Whitelist.
  # NullAddress only affects non-firewalled servers using IP Whitelist.
  nulladdress: true

  # Commands to run when a player is detected.
  punishments: []

# Prevents the use of invalid packets to exploit your server.
# This is the most advanced category in the plugin and it's not recommended to disable it.
packets:
  enabled: true

  # Amount of vls required to start cancelling packets.
  cancel_vls: 100

  # Amount of vls to reduce per second.
  reduce_vls: 60

  # Cancels packets if the player sending them is offline.
  offline: true

  # This will check if integers, floats, doubles and items have a invalid size in packets.
  data:
    # Vls to add when a packet fails the check. (Set to -1 to disable)
    vls: 600

    # Maximum amount of bytes allowed per packet. (Set to -1 to disable)
    bytes: 16000

    # Maximum amount of bytes allowed per book page. (Set to -1 to disable)
    bytes_book: 300

    # Maximum amount of bytes allowed per sign line. (Set to -1 to disable)
    bytes_sign: 47

    # Packets will add their amount of bytes divided by this number to vl count.
    # This is made so big packets add more vls when received.
    bytes_divider: 1000

  # Cancels book packets when a book is not in hand
  # Vls to add when a packet fails the check. (Set to -1 to disable)
  book: 100

  # Cancels CustomPayload packets with invalid tags
  # Vls to add when a packet fails the check. (Set to -1 to disable)
  tag: 600

  # Checks if players send PacketPlayInWindowClick packets with invalid data.
  # Vls to add when a packet fails the check. (Set to -1 to disable)
  window_click: 300

  # Checks if players send PacketPlayInBlockPlace packets with invalid data.
  # Vls to add when a packet fails the check. (Set to -1 to disable)
  block_place: 300

  # Checks if players send PacketPlayInBlockDig packets with invalid data.
  # Vls to add when a packet fails the check. (Set to -1 to disable)
  block_dig: 600

  # Checks if players send PacketPlayInCreativeSlot packets without creative.
  # Vls to add when a packet fails the check. (Set to -1 to disable)
  set_creative_slot: 600

  # Vls to add when a normal packet is sent by a player.
  # This option is made to work as a packet limiter feature.
  # Unlisted packets are considered as "PacketPlayInOther" by default.
  # Remember to take a look at bytes_divider option.
  multipliers:
    MC|BSign: 30
    MC|BEdit: 30
    MC|BOpen: 30
    PacketPlayInOther: 0.1
    PacketPlayInAbilities: 0.1
    PacketPlayInArmAnimation: 0.3
    PacketPlayInBlockDig: 0.3
    PacketPlayInBlockPlace: 0.4
    PacketPlayInCustomPayload: 0.04
    PacketPlayInEntityAction: 0.4
    PacketPlayInFlying: 0.05
    PacketPlayInLook: 0.1
    PacketPlayInPositionLook: 0.1
    PacketPlayInPosition: 0.35
    PacketPlayInSetCreativeSlot: 0.1
    PacketPlayInSettings: 0.5
    PacketPlayInTabComplete: 0.2
    PacketPlayInUpdateSign: 10
    PacketPlayInUseEntity: 0.4
    PacketPlayInUseItem: 0.4
    PacketPlayInWindowClick: 0.5

  # Placeholders: %player%
  # Commands to run when a player reachs certain violation level.
  violations:
    350:
      - "notification"
    600:
      - "notification"
      - "kick"

# Removes custom NBT tags from creative items to prevent harm to your server.
itemsfix:
  enabled: true

  # Maximum stack size obtainable with creative packets. (Set to -1 to allow everything)
  max_stack_size: 64

  # Maximum enchant level obtainable with creative packets. (-1 to disable)
  enchant_limit: 10

  # List of materials that are unobtainable from Creative.
  blacklist:
    - "END_PORTAL"
    - "NETHER_PORTAL"
  #  - "BARRIER"
  #  - "COMMAND_BLOCK"

# Checks if players try to crash/exploit the server with commands.
commands:
  enabled: true

  # Commands that are excempt from this server.
  commands:
    - "//calc"
    - "//calculate"
    - "//eval"
    - "//evaluate"
    - "//solve"
    - "/hd readtext"
    - "/holo readtext"
    - "/hologram readtext"
    - "/holograms readtext"
    - "/holographicdisplays readtext"
    - "/pex promote"
    - "/pex demote"
    - "/promote"
    - "/demote"
    - "/execute"

  # Placeholders: %player%
  punishments:
    - "notification"
    - "kick"
